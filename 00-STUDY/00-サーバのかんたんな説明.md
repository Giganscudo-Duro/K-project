

# ソフトウェア的には

TeraTerm や Putty 等の SSH クライアントを用いて接続する「SSH サーバ」ももうサーバと呼べるモノ。
結構知らない間に、サーバとクライアントを日常的に使ってる。

すっごく乱暴にまとめると、以下のような感じ。
- サービスを提供してれば「サーバ」
- サービスを利用してれば「クライアント」

上記2つを使ってるシステムを「サーバクライアントシステム」といったりする。

```txt
わかり易い例１：オンラインゲーム  
サーバ → サービス運営者が管理する。利用者は操作できない。  
クライアント → サービス利用者が手元の PC で操作する。しかし、サーバが動いていないと遊べない。  
```

```txt
わかり易い例２：HackMD  
サーバ → ツムラさんが管理する。利用者は操作できない  
クライアント → 我々の PC。サーバが起動してないと、講義のページは見れない  
```

```txt
わかり易い例３：よくあるパニックモノの映画「スパイダーシティ」  
サーバ → 女王蜘蛛。全ての兵隊蜘蛛の思考を司ってる  
クライアント → 兵隊蜘蛛。女王蜘蛛死ぬと、動かなくなる  
```

サービスと言うとどんなのがあるかと言うと
- 外部公開サービス（もちろんイントラネットでも利用可能）
    - DNS サーバ
        - Domain Name System
        - ホスト名解決のためのサービスを提供してくれる
        - TCP/IP ネットワーク上のコンピュータ全てに対し、割り振られた IP アドレスとそのホスト名を対応表を作って管理してくれる
    - WWW サーバ
        - World Wide Web
        - WWW ブラウザなどからの要求に応じて、HTMLや画像などの情報を提供してくれる
        - Apache だとか、高速かつ軽量な nginx、商用の Internet Information Services とかもある
    - FTP サーバ
        - File Transfer Protocol
        - コンピュータ感でファイルのやり取りを実現してくれる
        - ホームページ提供サービスに向けてファイルをアップロードする時に使われてたんじゃなかったっけ？
    - メールサーバ
    - Web アプリケーションサーバ
        - Web ブラウザを UI として利用し、DB 処理とかを行えるようにしてくれる
        - 構築がかんたん、クライアントの OS は何でも良い、とった具合に便利。
        - PHP とか Tomcat とか。

- 内部サービス（イントラネット向け）
    - DNS キャッシュサーバ
        - インターネット上にある DNS サーバから情報を得る処理を代行してくれる
        - 毎回 DNS に問い合わせるのは時間がかかるので、過去に調べた結果(DNSレコード)を内部に記憶し、それを社内の検索リクエストに返答してくれる感じ
        - 組織が前提ならばかなり重要
    - DHCP サーバ
        - Dynamic Host Configuration Protocol
        - ネットワーク上のコンピュータに対し、動的にネットワーク情報を割り当ててくれる
        - 実際、社給 PC でネットワークを設定する時、DHCP ってのを選択してるでしょ？あれはこのサービスを使ってるってこと
    - LDAP サーバ
        - Lightweight Directory Access Protocol
        - TCP/IP 上で動作するディレクトリアクセスプロトコル
        - 組織における Directory (日本語だと住所録、人名簿)を管理するサービス
        - 誰々はどこの部署に属してるだとか、誰々のメールアドレスは何だとか
    - NFS サーバ
        - Network File System
        - ホームディレクトリを含むファイルシステムの共有を可能にしてくれる
        - 仮想マシンのライブマイグレーションとかだと、このサービス利用が前提になってる
    - Samba サーバ
        - UNIX 系の OS に、Windows Network 接続のための機能をもたせてくれる
        - まぁコレを使うと、windows と Unix 系の間でファイルのやり取りが簡単になる、そんな認識でいいと思う
    - NTP サーバ
        - Network Time Protocol
        - ネットワークに接続された機器の時間の動機を取ることができるにしてくれる
    - Proxy サーバ
        - 社内でもコレに頭抱えることが多いアレのこと。
        - クライアントがインターネットへ直接アクセスできない場合に、「クライアント」と「インターネット上にあるサーバ」間の通信を中継してくれる
        - 通信を仲介するってことは、「クライアントの情報を隠したまま様々なサイトにアクセスできる」と同義なので、設定には注意が必要
        - ダレでもアクセスできるようインターネット上に公開されてるのをオープンプロキシとか言ったりするね

インターネット、イントラネットってのはネットワーク講座で説明があったと思うので、割愛。


# ハードウェア的には
基本的にパソコンとして提供されてるものでしかなく、前述の「サーバ用途」に特化したものが「サーバ」として売られてる。  
じゃあ、「サーバ用途に特化した」ってのはどんなことがあるかと言うと

- 長時間の連続稼働に耐える設計となっている
    - 通常のパソコンは連続稼働は考慮されていない
    - CPU、メモリ、記憶媒体、電源の多重化
    - パーツでのアクティブスタンバイを実現とか（見たこと無いけど）
- OS ベンダから認証を受けている
    - どこの馬の骨とも知らないPCを使ってる人間をサポートしたりしない
    - まぁそうでもしてないと、トラブルが起きた時、ソフトの不具合なのか、ハードの不具合なのか切り分けできない
    - サポート側にいた人間からすると、サポート対象の構築かどうかのチェックから始まったりする
- 特定用途に特化してる
    - NIC が多い
    - USB が多い


形についてはこんな感じで、複数のサーバをどのように配置するかを考慮しながら形状を選択する
- タワー型
- ラックマウント型
- ブレード型





# じゃあ実際にサーバを構築してみる
基本的に、サーバを建てるのはそんなに難しいことではない

1. マシンを用意する
2. OS をインストールする
3. ネットワーク設定を適切に行う
4. サービス利用に必要なパッケージをインストールする
5. サービス利用に必要な設定ファイルの編集を行う
6. セキュリティ設定を適切に行う
7. サービスを起動する

個人の環境で利用するなら、３と６はそこまで考慮する必要は無い。
ただし、会社で利用するとなると、厳密に意識して計画し、注意深く構築・運用することが必要。
ネットワークの設定をミスると、ネットワーク内にループが発生する（ブロードキャストストームなど）
セキュリティの設定をミスると、部外者にサービスを利用されてしまう（不正アクセスなど）
→ だから俺は設備管理者はヤッてもいいが、サーバ管理者はやりたくねぇと思ってる

# かんたんにサーバを立ててみる
とりあえず、かんたんに立てられて、なおかつよく使うサーバ2種を扱ってみる。
サーバってのはそんなに難しくないんだ、自分でもやれそうだ、というそれだけを感じてもらえればいいかな。

## WWW サーバを立ててみる
家で使うとしたら、自分用の wiki を立てる、グローバルソースツアーを立てるとか、かね。

とりあえず以下のコマンドを実行
```sh
# apt install apache2
```

```sh
# systemctl start apache2
# systemctl status apache2
```

そのあと、適当な html ファイルを `/var/www/html` 配下に配置すればOK



## Samba サーバを立ててみる
家だと、複数のマシン(OS違いもOK)の間でファイルを共有する共有サーバとして。

とりあえず 以下のコマンドを実行
```sh
# apt install samba
```

共有用のディレクトリを作る
```sh
# mkdir /home/samba-share
```


その後、設定ファイルを弄る
```sh
# vim /etc/samba/smb.conf
```
```txt
[grobal]
netbios name=KANAMARU-SAMBA
unix charset=UTF-8
dos charset=CP932
workgroup=WORKGROUP
guest account = nobody
map to guest = Bad User
security = user
dns proxy=no

[SHARE]
path=/home/share
writable=yes
browseable=yes
guest ok=yes

```







